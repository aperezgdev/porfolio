<script>
  const navLinks = document.querySelectorAll('nav > a')
  window.addEventListener('scroll', () => {
    const sections = document.querySelectorAll<HTMLElement>('main > article')

    let currentSection = ''

    sections.forEach(section => {
      const sectionTop = section.offsetTop
      if (scrollY >= sectionTop - 100) {
        currentSection = section.getAttribute('id') || ''
      }
    });

    if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight) {
      currentSection = sections[sections.length - 1].getAttribute('id') || ''
    }

    if(currentSection === '') return

    navLinks.forEach(link => {
      link.classList.remove('active')
      const href = link.getAttribute('href')
      if (href && href.substring(1) === currentSection) {
        link.classList.add('active')
      }
    })
  })

  navLinks.forEach((link) => {
    link.addEventListener('click', (ev) => {
      const clickedLink = ev.target
      if(clickedLink) {
        const activeLink = document.querySelector('.active')
        if (activeLink) {
          (clickedLink as HTMLElement).classList.toggle('active')
          activeLink.classList.toggle('active')
        }
      }
    })
  })
</script>


<nav>
  <a class="active" href="#aboutme">Sobre mi</a>
  <a href="#experience">Carrera</a>
  <a href="#projects">Proyectos</a>
  <a href="#posts">Publicaciones</a>
</nav>

<style>
  .active {
    color: black;
  }

  a {
    margin-inline: 1rem;
    cursor: pointer;
    color: #717171;
    text-decoration: none;
    display: inline-block;
    transition: color 0.1s;
    font-weight: 500;
  }
  a:hover {
    color: black;
  }

  a#home-link {
    text-decoration: none;
    color: black;
  }

  @media (max-width: 500px) {
    nav {
      display: none;
    }
  }

</style>
